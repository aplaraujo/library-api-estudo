CREATE TABLE autor (
  id uuid not null primary key,
  nome varchar(100) not null,
  data_nascimento date not null,
  nacionalidade varchar(50) not null,
  data_cadastro timestamp,
  data_atualizacao timestamp,
  id_usuario uuid
);

CREATE TABLE livro (
  id uuid not null primary key,
  isbn varchar(20) not null unique,
  titulo varchar(150) not null,
  data_publicacao date not null,
  genero varchar(30) not null,
  preco numeric(18,2),
  data_cadastro timestamp,
  data_atualizacao timestamp,
  id_usuario uuid,
  id_autor uuid not null references autor(id),
  constraint chk_genero check (genero in ('FICCAO', 'FANTASIA', 'MISTERIO', 'ROMANCE', 'BIOGRAFIA', 'CIENCIA'))
);

DROP TABLE usuario;
ALTER TABLE usuario add COLUMN email varchar(150) not null;

CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE usuario (
  id uuid not null primary key,
  login varchar(100) not null unique,
  email varchar(300) not null,
  senha varchar(300) not null,
  roles varchar[]
);

CREATE TABLE client (
  id uuid not null primary key,
  client_id varchar(150) not null,
  client_secret varchar(400) not null,
  redirect_uri varchar(50) not null,
  scope varchar(50)
);

INSERT INTO usu√°rio (id, login, senha, email, roles) VALUES (uuid_generate_v2(), 'gerente', '$2a$10$opeixEF4HxrAlaBiSXfFKOpScuoeSPlW1WkQHGzXEzE/uCfpKNAnS', 'gerente@email.com', '{GERENTE}');

INSERT INTO client (id, client_id, client_secret, redirect_uri, scope) VALUES (uuid_generate_v4(), 'gerente-client', 'gerente-secret', 'http://localhost:8080/authorized', 'GERENTE');